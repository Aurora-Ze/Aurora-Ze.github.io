<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
<!-- Referrer Policyè°ƒæ•´è‡´ä¸è’œå­å•é¡µé¢ç»Ÿè®¡å‡ºé”™:https://senorui.top/posts/c33f.html -->
<meta name="referrer" content="no-referrer-when-downgrade">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/icon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"aurora-ze.github.io.git","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":false,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":true},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="æ–‡æ¡£é“¾æ¥protocol-bufferså®˜ç½‘ proto3æ•™ç¨‹ é«˜æ•ˆçš„æ•°æ®å‹ç¼©ç¼–ç æ–¹å¼ Protobuf  protocol buffersä»€ä¹ˆæ˜¯protocol bufferså®˜æ–¹æ–‡æ¡£  Protocol buffers are Googleâ€™s language-neutral, platform-neutral, extensible mechanism for serializing st">
<meta property="og:type" content="article">
<meta property="og:title" content="Protobufå…¥é—¨">
<meta property="og:url" content="https://aurora-ze.github.io.git/2021/12/13/%E5%B7%A5%E5%85%B7/protocol%20buffers/index.html">
<meta property="og:site_name" content="Aurora">
<meta property="og:description" content="æ–‡æ¡£é“¾æ¥protocol-bufferså®˜ç½‘ proto3æ•™ç¨‹ é«˜æ•ˆçš„æ•°æ®å‹ç¼©ç¼–ç æ–¹å¼ Protobuf  protocol buffersä»€ä¹ˆæ˜¯protocol bufferså®˜æ–¹æ–‡æ¡£  Protocol buffers are Googleâ€™s language-neutral, platform-neutral, extensible mechanism for serializing st">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/Aurora-Ze/pictures/master/img/20210701200434.png">
<meta property="article:published_time" content="2021-12-13T12:06:09.672Z">
<meta property="article:modified_time" content="2021-08-29T04:31:16.166Z">
<meta property="article:author" content="aurora">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/Aurora-Ze/pictures/master/img/20210701200434.png">

<link rel="canonical" href="https://aurora-ze.github.io.git/2021/12/13/%E5%B7%A5%E5%85%B7/protocol%20buffers/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Protobufå…¥é—¨ | Aurora</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?dcdb42c8e3ad5d5a7981af32b9693ef3";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><link rel="alternate" href="/atom.xml" title="Aurora" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Aurora</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">çŸ¢å¿—å‰è¡Œï¼Œæ‹¥æŠ±æœªæ¥ï¼</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-ze.github.io.git/2021/12/13/%E5%B7%A5%E5%85%B7/protocol%20buffers/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://gitee.com/aurora1004/pictures/raw/master/sky-5375005_1920.jpg">
      <meta itemprop="name" content="aurora">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Aurora">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Protobufå…¥é—¨
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-12-13 20:06:09" itemprop="dateCreated datePublished" datetime="2021-12-13T20:06:09+08:00">2021-12-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-08-29 12:31:16" itemprop="dateModified" datetime="2021-08-29T12:31:16+08:00">2021-08-29</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%B7%A5%E5%85%B7/" itemprop="url" rel="index"><span itemprop="name">å·¥å…·</span></a>
                </span>
            </span>

          
            <span id="/2021/12/13/%E5%B7%A5%E5%85%B7/protocol%20buffers/" class="post-meta-item leancloud_visitors" data-flag-title="Protobufå…¥é—¨" title="é˜…è¯»æ¬¡æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="æ–‡æ¡£é“¾æ¥"><a href="#æ–‡æ¡£é“¾æ¥" class="headerlink" title="æ–‡æ¡£é“¾æ¥"></a>æ–‡æ¡£é“¾æ¥</h1><p><a target="_blank" rel="noopener" href="https://developers.google.com/protocol-buffers">protocol-bufferså®˜ç½‘</a></p>
<p><a target="_blank" rel="noopener" href="https://developers.google.com/protocol-buffers/docs/proto3">proto3æ•™ç¨‹</a></p>
<p><a target="_blank" rel="noopener" href="https://halfrost.com/protobuf_encode/#toc-0">é«˜æ•ˆçš„æ•°æ®å‹ç¼©ç¼–ç æ–¹å¼ Protobuf </a></p>
<h1 id="protocol-buffers"><a href="#protocol-buffers" class="headerlink" title="protocol buffers"></a>protocol buffers</h1><h3 id="ä»€ä¹ˆæ˜¯protocol-buffers"><a href="#ä»€ä¹ˆæ˜¯protocol-buffers" class="headerlink" title="ä»€ä¹ˆæ˜¯protocol buffers"></a>ä»€ä¹ˆæ˜¯protocol buffers</h3><p><strong>å®˜æ–¹æ–‡æ¡£</strong></p>
<blockquote>
<p>Protocol buffers are Googleâ€™s language-neutral, platform-neutral, extensible mechanism for serializing structured data â€“ think XML, but smaller, faster, and simpler. You define how you want your data to be structured once, then you can use special generated source code to easily write and read your structured data to and from a variety of data streams and using a variety of languages.</p>
</blockquote>
<p><strong>ç¿»è¯‘</strong></p>
<blockquote>
<p>protocol buffersæ˜¯Googleå¼€æºçš„ä¸€ç§å¯¹ç»“æ„åŒ–æ•°æ®è¿›è¡Œåºåˆ—åŒ–çš„æ–¹å¼ã€‚å®ƒå…·æœ‰è¯­è¨€æ— å…³ã€å¹³å°æ— å…³å’Œå¯æ‰©å±•æ€§ï¼›å’Œxmlç›¸æ¯”ï¼Œå®ƒæ›´å°ï¼Œæ›´å¿«å¹¶ä¸”æ›´åŠ ç®€å•ã€‚</p>
<p>ç”¨æˆ·åªéœ€è¦å®šä¹‰ä¸€æ¬¡æ‰€éœ€çš„ç»“æ„åŒ–æ•°æ®ï¼Œ å°±å¯ä»¥åˆ©ç”¨ç”Ÿæˆçš„å„ç§è¯­è¨€çš„ä»£ç ä»æ•°æ®æµä¸­è¯»å†™æ•°æ®</p>
</blockquote>
<h3 id="é€‰æ‹©è¯­è¨€è¿›è¡Œå®‰è£…"><a href="#é€‰æ‹©è¯­è¨€è¿›è¡Œå®‰è£…" class="headerlink" title="é€‰æ‹©è¯­è¨€è¿›è¡Œå®‰è£…"></a>é€‰æ‹©è¯­è¨€è¿›è¡Œå®‰è£…</h3><p><a target="_blank" rel="noopener" href="https://github.com/protocolbuffers/protobuf/releases">Releases Â· protocolbuffers/protobuf (github.com)</a></p>
<h1 id="ä¸€ã€å®šä¹‰Message"><a href="#ä¸€ã€å®šä¹‰Message" class="headerlink" title="ä¸€ã€å®šä¹‰Message"></a>ä¸€ã€å®šä¹‰Message</h1><p>ç¤ºä¾‹ï¼šåœ¨<code>.proto</code>æ–‡ä»¶ä¸­å®šä¹‰ä¸€ä¸ªåå«<code>SearchRequest</code>çš„æ¶ˆæ¯æ ¼å¼ï¼Œç”¨æ¥è¡¨ç¤ºæœç´¢çš„è¯·æ±‚</p>
<figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">syntax = <span class="string">&quot;proto3&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">option</span> go_package = <span class="string">&quot;./mvp&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">UserLoginReq</span> </span>&#123;</span><br><span class="line">        <span class="built_in">string</span> UserName = <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">string</span> Password = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">UserLoginRsp</span> </span>&#123;</span><br><span class="line">        <span class="built_in">bool</span> IsLogin = <span class="number">1</span>;</span><br><span class="line">        User UserInfo = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>

<ul>
<li>ç¬¬ä¸€è¡Œ<code>syntax = &quot;proto3&quot;</code>è¡¨ç¤ºä½¿ç”¨proto3çš„è¯­æ³•ï¼Œè¦æ”¾åœ¨æ­£æ–‡ï¼ˆéç©ºè¡Œå’Œéæ³¨é‡Šè¡Œï¼‰ä¸­çš„ç¬¬ä¸€è¡Œï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸€è¡Œï¼Œåˆ™è¡¨ç¤ºä½¿ç”¨proto2è¯­æ³•</li>
<li><code>go_package</code>æŒ‡å®šç”Ÿæˆç›®æ ‡ä»£ç çš„ç›®å½•</li>
<li>æ¶ˆæ¯ä½“<code>UserLoginReq</code>ç”±2ä¸ªå­—æ®µæ„æˆï¼Œæ¯ä¸ªå­—æ®µåŒ…å«ç±»å‹ã€åç§°å’Œå€¼ã€‚</li>
</ul>
<h3 id="1-1-æŒ‡å®šå­—æ®µç±»å‹"><a href="#1-1-æŒ‡å®šå­—æ®µç±»å‹" class="headerlink" title="1.1 æŒ‡å®šå­—æ®µç±»å‹"></a>1.1 æŒ‡å®šå­—æ®µç±»å‹</h3><p>å¦‚ç¤ºä¾‹ä¸­çš„<code>UserName</code>å­—æ®µï¼Œç±»å‹ä¸º<code>string</code>ï¼›</p>
<p>ç±»å‹æ—¢å¯ä»¥æ˜¯æ•°å€¼ç±»å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤åˆç±»å‹ï¼ˆæšä¸¾ã€å…¶ä»–æ¶ˆæ¯ä½“ï¼‰</p>
<h3 id="1-2-è®¾å®šå­—æ®µå€¼"><a href="#1-2-è®¾å®šå­—æ®µå€¼" class="headerlink" title="1.2 è®¾å®šå­—æ®µå€¼"></a>1.2 è®¾å®šå­—æ®µå€¼</h3><p>å­—æ®µå€¼æ˜¯å”¯ä¸€çš„ï¼Œè¢«ç”¨æ¥æ ‡è¯†è¯¥å­—æ®µåœ¨æ¶ˆæ¯çš„äºŒè¿›åˆ¶æ ¼å¼</p>
<p><strong>å­—æ®µå€¼ä»1åˆ°15ä½¿ç”¨ä¸€ä¸ªå­—èŠ‚æ¥ç¼–ç ï¼Œ16åˆ°2047ä½¿ç”¨ä¸¤ä¸ªå­—èŠ‚æ¥ç¼–ç ï¼Œå› æ­¤å¯¹äºé¢‘ç¹å‡ºç°çš„å­—æ®µï¼Œå®ƒçš„å€¼åº”è¯¥è®¾æˆ1åˆ°15ä¹‹é—´ã€‚</strong></p>
<p>å…³äºæ›´å¤šï¼Œå¯ä»¥å…ˆå»äº†è§£ä¸‹<code>protocol buffer</code>çš„ç¼–ç </p>
<h3 id="1-3-æŒ‡å®šå­—æ®µè§„åˆ™"><a href="#1-3-æŒ‡å®šå­—æ®µè§„åˆ™" class="headerlink" title="1.3 æŒ‡å®šå­—æ®µè§„åˆ™"></a>1.3 æŒ‡å®šå­—æ®µè§„åˆ™</h3><ul>
<li><p><strong>singular</strong></p>
<p>  è¡¨ç¤ºè¯¥å­—æ®µå‡ºç°æ¬¡æ•°ä¸å¤šäº1ï¼ˆ0ä¸ªæˆ–è€…1ä¸ªï¼‰</p>
<p>  proto3é»˜è®¤ä½¿ç”¨è¿™ç§è§„åˆ™</p>
</li>
<li><p><strong>repeated</strong></p>
<p>  è¡¨ç¤ºå­—æ®µå¯ä»¥å‡ºç°ä»»æ„æ¬¡ï¼Œå¯ä»¥ç†è§£æˆæ•°ç»„</p>
</li>
</ul>
<h1 id="äºŒã€å®šä¹‰Service"><a href="#äºŒã€å®šä¹‰Service" class="headerlink" title="äºŒã€å®šä¹‰Service"></a>äºŒã€å®šä¹‰Service</h1><p>å¦‚æœæƒ³è¦å°†ä¸Šé¢å®šä¹‰çš„<code>Message</code>ç±»å‹ç”¨äº<code>rpcè°ƒç”¨</code>ï¼Œå°±è¦å®šä¹‰ä¸€ä¸ªæœåŠ¡ï¼ŒæœåŠ¡ä¸­å¯ä»¥å£°æ˜å¤šä¸ªæ¥å£ã€‚</p>
<figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">service</span> <span class="title">LoginService</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">rpc</span> Login(UserLoginReq) <span class="keyword">returns</span> (UserLoginRsp)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-1-å®Œæ•´ç¤ºä¾‹"><a href="#2-1-å®Œæ•´ç¤ºä¾‹" class="headerlink" title="2.1 å®Œæ•´ç¤ºä¾‹"></a>2.1 å®Œæ•´ç¤ºä¾‹</h3><figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">syntax = <span class="string">&quot;proto3&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">option</span> go_package = <span class="string">&quot;./mvp&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">service</span> <span class="title">LoginService</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">rpc</span> Login(UserLoginReq) <span class="keyword">returns</span> (UserLoginRsp)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ç”¨æˆ·ç™»é™†è¯·æ±‚</span></span><br><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">UserLoginReq</span> </span>&#123;</span><br><span class="line">        <span class="built_in">string</span> UserName = <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">string</span> Password = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ç”¨æˆ·ç™»é™†å“åº”</span></span><br><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">UserLoginRsp</span> </span>&#123;</span><br><span class="line">        <span class="built_in">bool</span> IsLogin = <span class="number">1</span>;</span><br><span class="line">        User UserInfo = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ç”¨æˆ·æ¶ˆæ¯æ ¼å¼</span></span><br><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">        <span class="built_in">uint64</span> UserID = <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">string</span> NickName = <span class="number">2</span>;</span><br><span class="line">        <span class="built_in">uint64</span> Age = <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">repeated</span> <span class="built_in">string</span> ImgURL = <span class="number">4</span>;</span><br><span class="line">        UserType UserType = <span class="number">5</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰æšä¸¾ç±»å‹ï¼šç”¨æˆ·æƒé™ç±»å‹</span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">UserType</span> </span>&#123;</span><br><span class="line">        UT_Nil = <span class="number">0</span>;</span><br><span class="line">        UT_Visit = <span class="number">1</span>;</span><br><span class="line">        UT_Normal = <span class="number">2</span>;</span><br><span class="line">        UT_Admin = <span class="number">3</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="ä¸‰ã€ç”ŸæˆGoä»£ç "><a href="#ä¸‰ã€ç”ŸæˆGoä»£ç " class="headerlink" title="ä¸‰ã€ç”ŸæˆGoä»£ç "></a>ä¸‰ã€ç”ŸæˆGoä»£ç </h1><h3 id="3-1-ä¸‹è½½æ’ä»¶"><a href="#3-1-ä¸‹è½½æ’ä»¶" class="headerlink" title="3.1 ä¸‹è½½æ’ä»¶"></a>3.1 ä¸‹è½½æ’ä»¶</h3><p><code>protocol buffer complier</code>éœ€è¦ä¸€ä¸ªæ’ä»¶æ‰èƒ½ç”ŸæˆGoä»£ç ï¼Œå› æ­¤å…ˆä¸‹è½½æ’ä»¶ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go install google.golang.org/protobuf/cmd/protoc-gen-go@latest</span><br></pre></td></tr></table></figure>

<p>ä¸‹è½½å®Œæ¯•ååœ¨<code>$GOPATH/bin</code>è·¯å¾„ä¸‹ä¼šç”Ÿæˆ<code>protoc-gen-go</code></p>
<h3 id="3-2-åˆ©ç”¨æ’ä»¶ç”Ÿæˆä»£ç "><a href="#3-2-åˆ©ç”¨æ’ä»¶ç”Ÿæˆä»£ç " class="headerlink" title="3.2 åˆ©ç”¨æ’ä»¶ç”Ÿæˆä»£ç "></a>3.2 åˆ©ç”¨æ’ä»¶ç”Ÿæˆä»£ç </h3><p>åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ç”¨ç»ˆç«¯ï¼ˆæˆ–cmdï¼‰è¾“å…¥ä»¥ä¸‹å‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">protoc --go_out=. <span class="variable">$SRC_DIR</span>/addressbook.proto</span><br></pre></td></tr></table></figure>

<p>å‚æ•°è¯´æ˜</p>
<ul>
<li><p><code>go_out</code>ï¼šè¡¨ç¤ºç”Ÿæˆgoä»£ç </p>
</li>
<li><p><code>$SRC_DIR/addressbook.proto</code>ï¼šè¡¨ç¤ºåè®®æ‰€åœ¨ä½ç½®</p>
</li>
<li><p>å¦‚æœæƒ³è¦æŒ‡å®šä»£ç ç”Ÿæˆçš„ä½ç½®ï¼Œåˆ™åœ¨åè®®æ–‡ä»¶ä¸­æ·»åŠ </p>
  <figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">option</span> go_package = <span class="string">&quot;yourpath&quot;</span>;</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="å››ã€demo"><a href="#å››ã€demo" class="headerlink" title="å››ã€demo"></a>å››ã€demo</h1><h3 id="4-1-ç¼–ç å¹¶å†™å…¥æ–‡ä»¶"><a href="#4-1-ç¼–ç å¹¶å†™å…¥æ–‡ä»¶" class="headerlink" title="4.1 ç¼–ç å¹¶å†™å…¥æ–‡ä»¶"></a>4.1 ç¼–ç å¹¶å†™å…¥æ–‡ä»¶</h3><p>ä¸»è¦ä½¿ç”¨<code>Marshal()</code>è¿›è¡Œç¼–ç </p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// TestProtoWrite æµ‹è¯•æŠŠæ¶ˆæ¯å†™å…¥æŒ‡å®šæ–‡ä»¶ä¸­</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestProtoWrite</span><span class="params">()</span></span>  &#123;</span><br><span class="line">    login := &amp;mvp.UserLoginReq &#123;</span><br><span class="line">        UserName: <span class="string">&quot;zhangsan&quot;</span>,</span><br><span class="line">        Password: <span class="string">&quot;123&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    out, err := proto.Marshal(login)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        log.Fatalln(<span class="string">&quot;Fail to encode message login:&quot;</span>, err)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> err = ioutil.WriteFile(FilePath, out, fs.FileMode(<span class="number">777</span>)); err != <span class="literal">nil</span> &#123;</span><br><span class="line">        log.Fatalln(<span class="string">&quot;Fail to write file:&quot;</span>, err)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="4-2-è¯»å–æ¶ˆæ¯å¹¶è§£ç "><a href="#4-2-è¯»å–æ¶ˆæ¯å¹¶è§£ç " class="headerlink" title="4.2 è¯»å–æ¶ˆæ¯å¹¶è§£ç "></a>4.2 è¯»å–æ¶ˆæ¯å¹¶è§£ç </h3><p>ä½¿ç”¨<code>Unmarshal()</code>è¿›è¡Œè§£ç </p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// TestProtoRead æµ‹è¯•ä»æŒ‡å®šæ–‡ä»¶ä¸­è¯»å–æ¶ˆæ¯</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestProtoRead</span><span class="params">()</span></span>  &#123;</span><br><span class="line">    in, err := ioutil.ReadFile(FilePath)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        log.Fatalln(<span class="string">&quot;Fail to read file:&quot;</span>, err)</span><br><span class="line">    &#125;</span><br><span class="line">    login := &amp;mvp.UserLoginReq&#123;&#125;</span><br><span class="line">    <span class="keyword">if</span> err = proto.Unmarshal(in, login); err != <span class="literal">nil</span> &#123;</span><br><span class="line">        log.Fatalln(<span class="string">&quot;Fail to decode message login:&quot;</span>, err)</span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Println(login)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="äº”ã€ç¼–ç è¯¦è§£"><a href="#äº”ã€ç¼–ç è¯¦è§£" class="headerlink" title="äº”ã€ç¼–ç è¯¦è§£"></a>äº”ã€ç¼–ç è¯¦è§£</h1><h3 id="5-1-Base-128-Varints"><a href="#5-1-Base-128-Varints" class="headerlink" title="5.1 Base 128 Varints"></a>5.1 Base 128 Varints</h3><h5 id="å®˜æ–¹æ–‡æ¡£è¯´æ˜"><a href="#å®˜æ–¹æ–‡æ¡£è¯´æ˜" class="headerlink" title="å®˜æ–¹æ–‡æ¡£è¯´æ˜"></a>å®˜æ–¹æ–‡æ¡£è¯´æ˜</h5><blockquote>
<p>To understand your simple protocol buffer encoding, you first need to understand <em>varints</em>. Varints are a method of serializing integers using one or more bytes. Smaller numbers take a smaller number of bytes.</p>
<p>Each byte in a varint, except the last byte, has the <em>most significant bit</em> (msb) set â€“ this indicates that there are further bytes to come. The lower 7 bits of each byte are used to store the twoâ€™s complement representation of the number in groups of 7 bits, <strong>least significant group first</strong>.</p>
</blockquote>
<h5 id="ç¿»è¯‘"><a href="#ç¿»è¯‘" class="headerlink" title="ç¿»è¯‘"></a>ç¿»è¯‘</h5><blockquote>
<p>ä¸ºäº†å¸®åŠ©ä½ ç†è§£<code>protocol buffer</code>çš„ç¼–ç æ–¹å¼ï¼Œä½ éœ€è¦å…ˆäº†è§£ä¸€ä¸‹<code>varints</code>ã€‚<code>varints</code>æ˜¯ä¸€ç§å°†æ•´æ•°ç±»å‹åºåˆ—åŒ–æˆä¸€ä¸ªæˆ–å¤šä¸ªå­—èŠ‚çš„æ–¹æ³•ã€‚è¶Šå°çš„æ•°å­—åºåˆ—åŒ–åäº§ç”Ÿçš„å­—èŠ‚æ•°å°±è¶Šå°‘ã€‚</p>
<p>varintsä¸­é™¤äº†æœ€åä¸€ä¸ªå­—èŠ‚ï¼Œå…¶ä»–å­—èŠ‚çš„æœ€é«˜æœ‰æ•ˆä½éƒ½ç½®ä¸º1ï¼Œç”¨æ¥è¡¨ç¤ºæ¥ä¸‹æ¥è¿˜æœ‰å­—èŠ‚ï¼›å‰©ä½™çš„ä½7ä½åˆ™æ˜¯å¯¹æ¯7ä½ä¸ºä¸€ç»„çš„äºŒè¿›åˆ¶æ•°æ®çš„è¡¥ç è¡¨ç¤ºã€‚</p>
</blockquote>
<h5 id="ç¼–ç ç¤ºä¾‹"><a href="#ç¼–ç ç¤ºä¾‹" class="headerlink" title="ç¼–ç ç¤ºä¾‹"></a>ç¼–ç ç¤ºä¾‹</h5><p><img data-src="https://raw.githubusercontent.com/Aurora-Ze/pictures/master/img/20210701200434.png"></p>
<p>è§£ç è¿‡ç¨‹å°±æ˜¯ä¸Šè¿°ç¼–ç çš„é€†è¿‡ç¨‹ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°ã€‚</p>
<h3 id="5-2-æ¶ˆæ¯ç±»å‹ç¼–ç "><a href="#5-2-æ¶ˆæ¯ç±»å‹ç¼–ç " class="headerlink" title="5.2 æ¶ˆæ¯ç±»å‹ç¼–ç "></a>5.2 æ¶ˆæ¯ç±»å‹ç¼–ç </h3><blockquote>
<p>ä»ä¹‹å‰çš„æ¶ˆæ¯ç¤ºä¾‹ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œæ¶ˆæ¯æ˜¯ç”±ä¸€ç³»åˆ—çš„é”®å€¼å¯¹ç»„æˆçš„ã€‚</p>
</blockquote>
<h5 id="é”®å€¼å¯¹ä»‹ç»"><a href="#é”®å€¼å¯¹ä»‹ç»" class="headerlink" title="é”®å€¼å¯¹ä»‹ç»"></a>é”®å€¼å¯¹ä»‹ç»</h5><p>é”®è¢«ç§°ä¸º<code>tag</code>ï¼Œç”±<code>field number</code>å’Œ<code>wire type</code>æ„æˆï¼Œå‰è€…è¡¨ç¤ºè®¾å®šçš„å­—æ®µå·ï¼Œåè€…å¯ä»¥æŸ¥è¡¨å¾—ã€‚</p>
<p>å€¼å°±æ˜¯è¯¥å­—æ®µè¢«èµ‹äºˆçš„æ•°å€¼ã€‚</p>
<p><code>tag</code>çš„è®¡ç®—æ–¹å¼ä¸ºï¼š<br>$$<br>tag = (field number &lt;&lt; 3)  | wire type<br>$$<br>è¡¨æ ¼å¦‚ä¸‹ï¼Œå…¶ä¸­3ï¼Œ4å·²è¢«åºŸå¼ƒï¼Œå°±æ˜¯è¯´<code>wire type</code>å–å€¼åº”è¯¥åªæœ‰0ï¼Œ1ï¼Œ2ï¼Œ5ï¼Œå› æ­¤ç”¨ä¸‰æ¯”ç‰¹å³å¯è¡¨ç¤º<code>wire type</code>ã€‚</p>
<table>
<thead>
<tr>
<th align="left">Type</th>
<th align="left">Meaning</th>
<th align="left">Used For</th>
</tr>
</thead>
<tbody><tr>
<td align="left">0</td>
<td align="left">Varint</td>
<td align="left">int32, int64, uint32, uint64, sint32, sint64, bool, enum</td>
</tr>
<tr>
<td align="left">1</td>
<td align="left">64-bit</td>
<td align="left">fixed64, sfixed64, double</td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">Length-delimited</td>
<td align="left">string, bytes, embedded messages, packed repeated fields</td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">Start group</td>
<td align="left">groups (deprecated)</td>
</tr>
<tr>
<td align="left">4</td>
<td align="left">End group</td>
<td align="left">groups (deprecated)</td>
</tr>
<tr>
<td align="left">5</td>
<td align="left">32-bit</td>
<td align="left">fixed32, sfixed32, float</td>
</tr>
</tbody></table>
<h5 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h5><p>ç°æœ‰ä»¥ä¸‹æ¶ˆæ¯ï¼Œå‡è®¾ä¼ å…¥æ¶ˆæ¯ï¼Œaçš„å€¼æ˜¯150</p>
<figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">Test1</span> </span>&#123;</span><br><span class="line">    <span class="keyword">required</span> <span class="built_in">int32</span> a = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ¶ˆæ¯ä½“ç¼–ç åå¾—åˆ°çš„ç»“æœæ˜¯<code>08 96 01</code>ï¼ˆ16è¿›åˆ¶ï¼‰</p>
<ul>
<li><p>è®¡ç®—tag</p>
<p>  0001 ++ 000ï¼Œå¾—åˆ°<code>0001000</code>ï¼Œå³<strong>08</strong></p>
</li>
<li><p>å¯¹150è¿›è¡Œç¼–ç ï¼Œé‡‡å–ä¸Šè¿°<code>varints</code>æ–¹å¼</p>
<ul>
<li>10010110</li>
<li>1ï¼Œ0010110</li>
<li>00000001ï¼Œ10010110</li>
<li>å¾—åˆ°ç¼–ç <code>10010110ï¼Œ00000001</code></li>
<li>ç”¨16è¿›åˆ¶è¡¨ç¤ºï¼Œå³<strong>96 01</strong></li>
</ul>
</li>
</ul>
<h3 id="5-3-å­—ç¬¦ä¸²ç¼–ç "><a href="#5-3-å­—ç¬¦ä¸²ç¼–ç " class="headerlink" title="5.3 å­—ç¬¦ä¸²ç¼–ç "></a>5.3 å­—ç¬¦ä¸²ç¼–ç </h3><p>å’Œæ™®é€šçš„æ•´å‹ç›¸æ¯”ï¼Œå­—ç¬¦ä¸²åœ¨æ¶ˆæ¯ä½“ä¸­çš„ç¼–ç æ–¹å¼å¤šäº†ä¸€ä¸ªlengthï¼Œè¡¨ç¤ºå­—ç¬¦ä¸²ç¼–ç åçš„é•¿åº¦ã€‚</p>
<p>å½¢å¼ä¸º<code>key length content</code>ã€‚</p>
<h5 id="ç¤ºä¾‹-1"><a href="#ç¤ºä¾‹-1" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h5><p>bèµ‹å€¼ä¸ºtesting</p>
<figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">Test2</span> </span>&#123;</span><br><span class="line">    <span class="keyword">optional</span> <span class="built_in">string</span> b = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¼–ç åçš„ç»“æœæ˜¯<code>12 07 74 65 73 74 69 6e 67</code></p>
<p>å…¶ä¸­<strong>07</strong>è¡¨ç¤ºé•¿åº¦ï¼Œåé¢çš„7ä¸ª16è¿›åˆ¶å°±æ˜¯testingçš„utf8ç¼–ç </p>
<p>æœ€å¼€å§‹çš„<strong>12</strong>å°±æ˜¯keyï¼Œç”±0010010è½¬æ¢æˆ16è¿›åˆ¶å¾—åˆ°ã€‚</p>
<h2 id="å…­ã€"><a href="#å…­ã€" class="headerlink" title="å…­ã€"></a>å…­ã€</h2>
    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>aurora
  </li>
  <li class="post-copyright-link">
    <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
    <a href="https://aurora-ze.github.io.git/2021/12/13/%E5%B7%A5%E5%85%B7/protocol%20buffers/" title="Protobufå…¥é—¨">https://aurora-ze.github.io.git/2021/12/13/å·¥å…·/protocol buffers/</a>
  </li>
  <li class="post-copyright-license">
    <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
  </li>
</ul>
</div>


      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/12/13/%E5%B7%A5%E5%85%B7/maven%E9%97%AE%E9%A2%98%E5%B0%8F%E8%AE%B0/" rel="prev" title="Mavené—®é¢˜å’Œè§£å†³æ–¹æ¡ˆè®°å½•">
      <i class="fa fa-chevron-left"></i> Mavené—®é¢˜å’Œè§£å†³æ–¹æ¡ˆè®°å½•
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/12/13/%E5%B7%A5%E5%85%B7/%E4%B9%A6%E5%8D%95/" rel="next" title="ä¹¦å•">
      ä¹¦å• <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%96%87%E6%A1%A3%E9%93%BE%E6%8E%A5"><span class="nav-text">æ–‡æ¡£é“¾æ¥</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#protocol-buffers"><span class="nav-text">protocol buffers</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFprotocol-buffers"><span class="nav-text">ä»€ä¹ˆæ˜¯protocol buffers</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%89%E6%8B%A9%E8%AF%AD%E8%A8%80%E8%BF%9B%E8%A1%8C%E5%AE%89%E8%A3%85"><span class="nav-text">é€‰æ‹©è¯­è¨€è¿›è¡Œå®‰è£…</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E5%AE%9A%E4%B9%89Message"><span class="nav-text">ä¸€ã€å®šä¹‰Message</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-%E6%8C%87%E5%AE%9A%E5%AD%97%E6%AE%B5%E7%B1%BB%E5%9E%8B"><span class="nav-text">1.1 æŒ‡å®šå­—æ®µç±»å‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-%E8%AE%BE%E5%AE%9A%E5%AD%97%E6%AE%B5%E5%80%BC"><span class="nav-text">1.2 è®¾å®šå­—æ®µå€¼</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-%E6%8C%87%E5%AE%9A%E5%AD%97%E6%AE%B5%E8%A7%84%E5%88%99"><span class="nav-text">1.3 æŒ‡å®šå­—æ®µè§„åˆ™</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E5%AE%9A%E4%B9%89Service"><span class="nav-text">äºŒã€å®šä¹‰Service</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-%E5%AE%8C%E6%95%B4%E7%A4%BA%E4%BE%8B"><span class="nav-text">2.1 å®Œæ•´ç¤ºä¾‹</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E7%94%9F%E6%88%90Go%E4%BB%A3%E7%A0%81"><span class="nav-text">ä¸‰ã€ç”ŸæˆGoä»£ç </span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-%E4%B8%8B%E8%BD%BD%E6%8F%92%E4%BB%B6"><span class="nav-text">3.1 ä¸‹è½½æ’ä»¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-%E5%88%A9%E7%94%A8%E6%8F%92%E4%BB%B6%E7%94%9F%E6%88%90%E4%BB%A3%E7%A0%81"><span class="nav-text">3.2 åˆ©ç”¨æ’ä»¶ç”Ÿæˆä»£ç </span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9B%9B%E3%80%81demo"><span class="nav-text">å››ã€demo</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-%E7%BC%96%E7%A0%81%E5%B9%B6%E5%86%99%E5%85%A5%E6%96%87%E4%BB%B6"><span class="nav-text">4.1 ç¼–ç å¹¶å†™å…¥æ–‡ä»¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-%E8%AF%BB%E5%8F%96%E6%B6%88%E6%81%AF%E5%B9%B6%E8%A7%A3%E7%A0%81"><span class="nav-text">4.2 è¯»å–æ¶ˆæ¯å¹¶è§£ç </span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%94%E3%80%81%E7%BC%96%E7%A0%81%E8%AF%A6%E8%A7%A3"><span class="nav-text">äº”ã€ç¼–ç è¯¦è§£</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-Base-128-Varints"><span class="nav-text">5.1 Base 128 Varints</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%E8%AF%B4%E6%98%8E"><span class="nav-text">å®˜æ–¹æ–‡æ¡£è¯´æ˜</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BF%BB%E8%AF%91"><span class="nav-text">ç¿»è¯‘</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BC%96%E7%A0%81%E7%A4%BA%E4%BE%8B"><span class="nav-text">ç¼–ç ç¤ºä¾‹</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-%E6%B6%88%E6%81%AF%E7%B1%BB%E5%9E%8B%E7%BC%96%E7%A0%81"><span class="nav-text">5.2 æ¶ˆæ¯ç±»å‹ç¼–ç </span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%94%AE%E5%80%BC%E5%AF%B9%E4%BB%8B%E7%BB%8D"><span class="nav-text">é”®å€¼å¯¹ä»‹ç»</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B"><span class="nav-text">ç¤ºä¾‹</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%BC%96%E7%A0%81"><span class="nav-text">5.3 å­—ç¬¦ä¸²ç¼–ç </span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-1"><span class="nav-text">ç¤ºä¾‹</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%AD%E3%80%81"><span class="nav-text">å…­ã€</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="aurora"
      src="https://gitee.com/aurora1004/pictures/raw/master/sky-5375005_1920.jpg">
  <p class="site-author-name" itemprop="name">aurora</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">144</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">27</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Aurora-Ze" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;Aurora-Ze" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:88775682whz@gmail.com" title="E-Mail â†’ mailto:88775682whz@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>
      
      
       <div>
          <iframe class="cc-license motion-element" frameborder="no" border="0" marginwidth="0" marginheight="0" width="280" height="86" src="//music.163.com/outchain/player?type=2&id=3986241&auto=1&height=32"></iframe>
       </div>
      

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">aurora</span>
</div>

<!--
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> å¼ºåŠ›é©±åŠ¨
    <span class="post-count">| åšå®¢å…±95.3kå­—</span>
  </div>-->


<!-- ç½‘ç«™è¿è¡Œæ—¶é—´çš„è®¾ç½® -->
<span id="timeDate">è½½å…¥å¤©æ•°...</span>
<span id="times">è½½å…¥æ—¶åˆ†ç§’...</span>
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("04/07/2021 15:54:40");//æ­¤å¤„ä¿®æ”¹ä½ çš„å»ºç«™æ—¶é—´æˆ–è€…ç½‘ç«™ä¸Šçº¿æ—¶é—´
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "æœ¬ç«™å·²å®‰å…¨è¿è¡Œ "+dnum+" å¤© ";
        document.getElementById("times").innerHTML = hnum + " å°æ—¶ " + mnum + " åˆ† " + snum + " ç§’";
    }
setInterval("createtime()",250);
</script>

        






<script>
  (function() {
    function leancloudSelector(url) {
      url = encodeURI(url);
      return document.getElementById(url).querySelector('.leancloud-visitors-count');
    }

    function addCount(Counter) {
      var visitors = document.querySelector('.leancloud_visitors');
      var url = decodeURI(visitors.id);
      var title = visitors.dataset.flagTitle;

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url })))
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length > 0) {
            var counter = results[0];
            leancloudSelector(url).innerText = counter.time + 1;
            Counter('put', '/classes/Counter/' + counter.objectId, { time: { '__op': 'Increment', 'amount': 1 } })
              .catch(error => {
                console.error('Failed to save visitor count', error);
              });
          } else {
              leancloudSelector(url).innerText = 'Counter not initialized! More info at console err msg.';
              console.error('ATTENTION! LeanCloud counter has security bug, see how to solve it here: https://github.com/theme-next/hexo-leancloud-counter-security. \n However, you can still use LeanCloud without security, by setting `security` option to `false`.');
            
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    function showTime(Counter) {
      var visitors = document.querySelectorAll('.leancloud_visitors');
      var entries = [...visitors].map(element => {
        return decodeURI(element.id);
      });

      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify({ url: { '$in': entries } })))
        .then(response => response.json())
        .then(({ results }) => {
          for (let url of entries) {
            let target = results.find(item => item.url === url);
            leancloudSelector(url).innerText = target ? target.time : 0;
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }

    let { app_id, app_key, server_url } = {"enable":true,"app_id":"onLEwKPIGR1aCmBdwGejbexF-MdYXbMMI","app_key":"t2siWdIpwwli1r3ESEAjtitV","server_url":"https://onlewkpi.api.lncldglobal.com","security":true};
    function fetchData(api_server) {
      var Counter = (method, url, data) => {
        return fetch(`${api_server}/1.1${url}`, {
          method,
          headers: {
            'X-LC-Id'     : app_id,
            'X-LC-Key'    : app_key,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost) {
        if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      } else if (document.querySelectorAll('.post-title-link').length >= 1) {
        showTime(Counter);
      }
    }

    let api_server = app_id.slice(-9) !== '-MdYXbMMI' ? server_url : `https://${app_id.slice(0, 8).toLowerCase()}.api.lncldglobal.com`;

    if (api_server) {
      fetchData(api_server);
    } else {
      fetch('https://app-router.leancloud.cn/2/route?appId=' + app_id)
        .then(response => response.json())
        .then(({ api_server }) => {
          fetchData('https://' + api_server);
        });
    }
  })();
</script>


      </div>
    </footer>
  </div>

  


  <script src=""></script>
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="/lib/darkmode-js.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>


<script>
var options = {
  bottom: '64px', // default: '32px'
  right: 'unset', // default: '32px'
  left: '32px', // default: 'unset'
  time: '0.5s', // default: '0.3s'
  mixColor: 'transparent', // default: '#fff'
  backgroundColor: 'transparent',  // default: '#fff'
  buttonColorDark: '#100f2c',  // default: '#100f2c'
  buttonColorLight: '#fff', // default: '#fff'
  saveInCookies: true, // default: true,
  label: 'ğŸŒ“', // default: ''
  autoMatchOsTheme: true // default: true
}
const darkmode = new Darkmode(options);
darkmode.showWidget();
</script>
<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":200,"height":400},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
