---
title: 信件错排
categories: 数据结构与算法
tags:
	- 动态规划
---



# 1.信件错排

### 描述

存在**n个信封**和**n封信**，每封信都有个正确的信封存放，那么所有信**都放错**的情况有几种？

可以只写出转移方程

### 解法

$dp[i]$ 表示 $i$ 封信错排的总数

假设现在有5个信封和5封信，编号为1~5

如果我们把`信1`放入到`信封2`中，那么`信2`想要维持错排的状态，就有两种可能：一是放入`信封1`，二是放到`其他信封(3,4,5)`中



![](E:\吴和泽\LearningFile\resources\dp-2.PNG)

针对情况一，信2放入到信封1后，就剩下了编号为**3、4、5**的信和信封，问题就转化为求3封信3个信封错排情况，即 $dp[i-2]$

针对情况二，信2要放入**3、4、5**中，如果我们把`信2`和`信封1`看成是一对，就有四对要错排的元素，那么就变成了求四封信四个信封的错排数，即 $dp[i-1]$

### 综上

信1放入信封2时， $dp[i] = dp[i-1] + dp[i-2]$

而最开始，信1还可能放到**3、4、5**中，总共有 $n-1$ 种可能

**所以**：
$$
dp[i] = (i-1) * (dp[i-1] + dp[i-2])
$$
至于具体解，可以通过 **一个for循环** 和 **滑动窗口** 来计算